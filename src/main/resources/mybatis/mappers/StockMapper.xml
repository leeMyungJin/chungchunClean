<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.chungchunClean.Mappers.StockMapper">

<select id="getStockList" parameterType="hashMap" resultType="hashMap">
	select
		A.l_categy_cd ,
		A.l_categy_nm ,
		A.m_categy_cd ,
		A.m_categy_nm ,
		B.item_cd ,
		B.item_nm,
		B.qr_url,
		B.cost
	from
		web.category_bas A
	left outer join WEB.category_dtl B on
		a.l_categy_cd = b.l_categy_cd
		and a.m_categy_cd = b.m_categy_cd
	where
		1 = 1
	<if test="inq != null">
	AND 
		<choose>
			<when test="con == 'all'">
				<foreach collection="inq" item="item"
					index="index" open="(" close=")" separator="or">
					A.l_categy_nm LIKE '%' || #{item} || '%'
					or
					A.m_categy_nm LIKE '%' || #{item} || '%'
					or
					B.item_nm LIKE '%' || #{item} || '%'
				</foreach>
			</when>
			<when test="con == 'category'">
				<foreach collection="inq" item="item"
					index="index" open="(" close=")" separator="or">
					A.l_categy_nm LIKE '%' || #{item} || '%'
					or
					A.m_categy_nm LIKE '%' || #{item} || '%'
				</foreach>
			</when>
			<when test="con == 'product'">
				<foreach collection="inq" item="item"
					index="index" open="(" close=")" separator="or">
					B.item_nm LIKE '%' || #{item} || '%'
				</foreach>
			</when>
		</choose>
	</if>
</select>
</mapper>